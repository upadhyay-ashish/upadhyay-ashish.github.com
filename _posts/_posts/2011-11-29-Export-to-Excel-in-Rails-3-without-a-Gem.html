---           
layout: post
title: Export to Excel in Rails 3 without a Gem
date: 2011-11-29 21:02:54 UTC
updated: 2011-11-29 21:02:54 UTC
comments: false
categories: excel export rails xls export rails excel export rails 3 excel export ror xls export in ror xls export rails 3 xls export in ruby excel export ruby
---

<div dir="ltr" style="text-align: left;" trbidi="on">
<h3 class="post-title entry-title" style="font-family: &quot;Courier New&quot;,Courier,monospace;">



Export to Excel in Rails 3 without a Gem</h3>
<div class="MsoNoSpacing" style="font-family: &quot;Courier New&quot;,Courier,monospace;">
</div>
<div class="MsoNoSpacing" style="font-family: &quot;Courier New&quot;,Courier,monospace;">
</div>
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">
</span><br />
<h2 style="font-family: &quot;Courier New&quot;,Courier,monospace;">







<span style="font-size: medium;">Creating Demo project</span></h2>
<blockquote class="tr_bq" style="background-color: #cccccc; font-family: &quot;Courier New&quot;,Courier,monospace;">
<div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-size: 10pt;">&nbsp;rails new xcel_demo â€“d mysql</span></div>
</blockquote>
<h2 style="font-family: &quot;Courier New&quot;,Courier,monospace;">







<span style="font-size: small;">Creating a User model</span></h2>
<blockquote class="tr_bq" style="background-color: #cccccc; font-family: &quot;Courier New&quot;,Courier,monospace;">
<div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-size: 10pt;">rails g scaffold User name:string
email:string content:string</span></div>
</blockquote>
<div class="MsoNormal" style="font-family: &quot;Courier New&quot;,Courier,monospace; line-height: normal; margin-bottom: 0in;">
</div>
<h2 style="font-family: &quot;Courier New&quot;,Courier,monospace;">


<span style="font-size: small;">Add a MIME type in \config\initializers\mime_type.rb</span></h2>
<blockquote class="tr_bq" style="background-color: #cccccc; font-family: &quot;Courier New&quot;,Courier,monospace;">
<div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-size: 10pt;">Mime::Type.register 'application/vnd.ms-excel', :xls</span></div>
</blockquote>
<h2 style="font-family: &quot;Courier New&quot;,Courier,monospace;">


<span style="font-size: small;">Add a xls format output to the method in the Controller</span></h2>
<div class="MsoNormal" style="font-family: &quot;Courier New&quot;,Courier,monospace; line-height: normal; margin-bottom: 0in;">
</div>
<blockquote class="tr_bq" style="background-color: #cccccc; font-family: &quot;Courier New&quot;,Courier,monospace;">
&nbsp;
def index<br />
&nbsp;&nbsp;&nbsp; @users = User.all<br />
<br />
&nbsp;&nbsp;&nbsp; respond_to do |format|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; format.html # index.html.erb<br />
&nbsp;&nbsp;&nbsp; &nbsp; format.xls<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; format.xml&nbsp; { render :xml =&gt; @users }<br />
&nbsp;&nbsp;&nbsp; end<br />
&nbsp; end</blockquote>
<span style="background-color: #cccccc; font-family: &quot;Courier New&quot;,Courier,monospace;"></span><br />
<h2 style="font-family: &quot;Courier New&quot;,Courier,monospace;">


<span style="font-size: small;">




Creating the view for the XLS</span></h2>
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">
</span>
<br />
<div class="MsoNormal" style="font-family: &quot;Courier New&quot;,Courier,monospace; line-height: normal; margin-bottom: 0in;">
<span style="font-size: 10pt;">Now create a view to render the xls file. Here as we have modified the index method we will create a view index.xls.erb for the same in the views for Users</span></div>
<div class="MsoNormal" style="font-family: &quot;Courier New&quot;,Courier,monospace; line-height: normal; margin-bottom: 0in;">
</div>
<blockquote class="tr_bq" style="background-color: #cccccc; font-family: &quot;Courier New&quot;,Courier,monospace;">
&lt;h1&gt;Listing users&lt;/h1&gt;<br />
<br />
&lt;table&gt;<br />
&nbsp; &lt;tr&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;Name&lt;/th&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;City&lt;/th&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;Gender&lt;/th&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;Phone&lt;/th&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;Address&lt;/th&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;&lt;/th&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;&lt;/th&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;th&gt;&lt;/th&gt;<br />
&nbsp; &lt;/tr&gt;<br />
<br />
&lt;% @users.each do |user| %&gt;<br />
&nbsp; &lt;tr&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;%= user.name %&gt;&lt;/td&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;%= user.city %&gt;&lt;/td&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;%= user.gender %&gt;&lt;/td&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;%= user.phone %&gt;&lt;/td&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;%= user.address %&gt;&lt;/td&gt;<br />
&nbsp; &lt;/tr&gt;<br />
&lt;% end %&gt;<br />
&lt;/table&gt;<br />
<br />
&lt;br /&gt;</blockquote>
<div class="MsoNormal" style="font-family: &quot;Courier New&quot;,Courier,monospace; line-height: normal; margin-bottom: 0in;">
The text in the &lt;th&gt; tags are the headers and &lt;td&gt; tags are the data for the specified columns</div>
<h2 style="font-family: &quot;Courier New&quot;,Courier,monospace;">







<span style="font-size: small;">Adding the link to export excel on the Index page</span></h2>
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">
</span><br />
<div class="MsoNormal" style="font-family: &quot;Courier New&quot;,Courier,monospace; line-height: normal; margin-bottom: 0in;">
</div>
<blockquote class="tr_bq" style="background-color: #cccccc; font-family: &quot;Courier New&quot;,Courier,monospace;">
&nbsp;&lt;%= link_to 'Export XLS', url_for(:format =&gt; 'xls') %&gt;</blockquote>
<div style="font-family: &quot;Courier New&quot;,Courier,monospace;">
</div>
<div style="font-family: &quot;Courier New&quot;,Courier,monospace;">
</div>
<div style="font-family: &quot;Courier New&quot;,Courier,monospace;">
This will allow the data on index page to be exported in Excel Format.</div>
</div><img src="http://feeds.feedburner.com/~r/blogspot/GMijy/~4/jiE-rCSpvGA" height="1" width="1"/>